unit_tests:
  - name: test_is_valid_email_address
    description: "Check my is_valid_email_address logic captures all known edge cases - emails without ., emails without @, and emails from invalid domains."
    model: stg_studenti_scuola_statale_source__studenti_scuola_statale
    given:
      - input: source('studenti_scuola_statale_source', 'studenti_scuola_statale')
        rows:
          - {indirizzoemailscuola: cool@istruzione.it}
          - {indirizzoemailscuola: cool@unknown.com}
          - {indirizzoemailscuola: badgmail.com}
          - {indirizzoemailscuola: missingdot@gmailcom}
    expect:
      rows:
        - {indirizzoemailscuola: cool@istruzione.it,    is_valid_email_address: true}
        - {indirizzoemailscuola: cool@unknown.com,    is_valid_email_address: false}
        - {indirizzoemailscuola: badgmail.com,        is_valid_email_address: false}
        - {indirizzoemailscuola: missingdot@gmailcom, is_valid_email_address: false}